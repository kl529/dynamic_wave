# 📊 동파법 SOXL 매매 전략 상세 문서

> **기준 문서**: 구글 시트 동파법 전략 분석
> **최종 업데이트**: 2025-01-11
> **버전**: 3.0 (5분할 독립 운영)

---

## 🎯 전략 개요

**동파법 (Dongpa Method)**은 레버리지 ETF의 높은 변동성을 활용한 **분할별 독립 매매** 전략입니다.

### **핵심 원리**
- **대상 종목**: SOXL (반도체 3배 레버리지 ETF)
- **매매 기준**: **종가(Close Price)** 기준
- **분할 횟수**: **5분할 고정**
- **핵심 특징**: **각 분할이 독립적으로 운영** (개별 매수일, 개별 평단가, 개별 매도)
- **전략**: 하락 시 분할 매수 → 개별 분할 조건 충족 시 해당 분할만 매도
- **위험 관리**: 분할별 최대 보유기간으로 손실 제한

---

## 💡 핵심 개념: 분할별 독립 운영

### **각 분할은 별도의 포트폴리오**

```javascript
// ❌ 잘못된 이해: 전체를 하나로 관리
전체_보유량 = 211주
전체_평단가 = $28.50
→ 한번에 전량 매도

// ✅ 올바른 이해: 각 분할을 독립 관리
분할1: { 매수일: 1/1, 보유: 68주, 평단가: $29.10, 보유일수: 5일 }
분할2: { 매수일: 1/3, 보유: 70주, 평단가: $28.20, 보유일수: 3일 }
분할3: { 매수일: 1/5, 보유: 73주, 평단가: $27.30, 보유일수: 1일 }
→ 조건 충족한 분할만 개별 매도
```

### **실전 예시**

```javascript
// Day 1 (월요일): 1분할 매수 신호
앱: "1분할 매수: 68주 (@$29.10)"

// Day 3 (화요일): 2분할 매수 신호
앱: "2분할 매수: 70주 (@$28.20)"

// Day 5 (수요일): 1분할 매도 + 3분할 매수
앱: "1분할 매도: 68주 (+0.2% 수익)"
앱: "3분할 매수: 73주 (@$27.30)"
→ 실제 실행: 68주 매도하고 73주 매수 = 순5주 매수

// Day 7 (목요일): 2분할 매도만
앱: "2분할 매도: 70주 (+0.3% 수익)"
→ 실제 실행: 70주 매도만
```

---

## ⚙️ 기본 설정

### **1. 투자 설정**
```javascript
{
  initialCapital: 사용자_입력,  // 최초 투자금 (예: $10,000)
  divisions: 5,                 // 5분할 고정
  mode: 'safe' | 'aggressive'   // 안전모드 또는 공세모드
}
```

### **2. 분할 구조**
```javascript
// 5분할 독립 포트폴리오
portfolio = {
  division1: {
    cash: $2,000,      // 분할 전용 현금
    holdings: 0,       // 보유 주식
    avgPrice: 0,       // 평단가
    buyDate: null,     // 매수일
    status: 'EMPTY'    // EMPTY, HOLDING
  },
  division2: { cash: $2,000, holdings: 0, ... },
  division3: { cash: $2,000, holdings: 0, ... },
  division4: { cash: $2,000, holdings: 0, ... },
  division5: { cash: $2,000, holdings: 0, ... }
}
```

### **3. 수수료 구조**
```javascript
거래_수수료 = 0.044%      // 0.00044
SEC_Fee = 0.00278%        // 0.0000278
총_편도_수수료 = 0.047%    // 매수 시 + 매도 시 각각 적용
```

---

## 📈 매수 전략 (분할별 독립)

### **매수 조건 확인**

```javascript
// 매일 장 마감 후 각 분할별로 조건 체크
for (let i = 1; i <= 5; i++) {
  const division = portfolio[`division${i}`];

  // 해당 분할이 비어있고 매수 조건 충족 시
  if (division.status === 'EMPTY' &&
      변동률 <= -매수목표하락률 &&
      division.cash >= 분할금액) {

    // 해당 분할만 매수
    division.holdings = Math.floor(division.cash / 오늘종가);
    division.avgPrice = 오늘종가;
    division.buyDate = 오늘날짜;
    division.cash = 0;
    division.status = 'HOLDING';

    console.log(`${i}분할 매수: ${division.holdings}주 @$${오늘종가}`);
  }
}
```

### **모드별 매수 조건**

#### **안전모드**
```javascript
{
  매수_목표_하락률: -3.0%,
  매도_목표_수익률: +0.2%,
  최대_보유_기간: 30일
}

// 예시
전일_종가 = $30.00
오늘_종가 = $29.10 (-3.0%)
→ 비어있는 분할 1개 매수
```

#### **공세모드**
```javascript
{
  매수_목표_하락률: -5.0%,
  매도_목표_수익률: +2.5%,
  최대_보유_기간: 7일
}

// 예시
전일_종가 = $30.00
오늘_종가 = $28.50 (-5.0%)
→ 비어있는 분할 1개 매수
```

---

## 💰 매도 전략 (분할별 독립)

### **매도 조건 확인 (각 분할별로 체크)**

```javascript
// 매일 장 마감 후 각 분할별로 매도 조건 체크
for (let i = 1; i <= 5; i++) {
  const division = portfolio[`division${i}`];

  if (division.status === 'HOLDING') {
    // 수익률 계산
    const 수익률 = (오늘종가 - division.avgPrice) / division.avgPrice;

    // 보유기간 계산
    const 보유일수 = 오늘날짜 - division.buyDate;

    // 매도 조건 1: 목표 수익률 달성
    if (수익률 >= 매도목표수익률) {
      매도실행(i, division, '수익');
    }

    // 매도 조건 2: 최대 보유기간 초과 (손절)
    else if (보유일수 >= 최대보유기간) {
      매도실행(i, division, '손절');
    }
  }
}

function 매도실행(분할번호, division, 사유) {
  const 매도금액 = division.holdings × 오늘종가;
  const 수수료 = 매도금액 × 0.00047;
  const 순수익 = 매도금액 - (division.holdings × division.avgPrice) - 수수료;

  // 분할 초기화
  division.cash = 매도금액 - 수수료;
  division.holdings = 0;
  division.avgPrice = 0;
  division.buyDate = null;
  division.status = 'EMPTY';

  console.log(`${분할번호}분할 ${사유} 매도: ${순수익.toFixed(2)}`);
}
```

### **안전모드 매도**
```javascript
// 분할1 예시
매수일: 1/1
매수가: $29.10
보유량: 68주

// 5일 후 (1/6)
오늘_종가: $29.16
수익률: +0.206%
→ 분할1만 매도 ✅

// 분할2는 계속 보유
매수일: 1/3
매수가: $28.20
보유일수: 3일
수익률: +3.4%
→ 목표 달성하여 함께 매도 ✅
```

### **공세모드 매도**
```javascript
// 분할1 예시
매수일: 1/1
매수가: $27.00
보유량: 74주

// 3일 후 (1/4)
오늘_종가: $27.68
수익률: +2.52%
→ 분할1만 매도 ✅

// 분할2는 아직 미달
매수일: 1/2
매수가: $26.50
보유일수: 2일
수익률: +4.45%
→ 함께 매도 ✅
```

---

## 🔄 실전 매매 사이클 예시

### **안전모드 분할별 독립 운영**

```javascript
// 초기 설정
최초_투자금 = $10,000
분할당_금액 = $2,000
매수_목표 = -3.0%
매도_목표 = +0.2%
최대_보유 = 30일

// ====================================
// Day 1 (월요일): 3.33% 하락
// ====================================
전일_종가 = $30.50
오늘_종가 = $29.48 (-3.34%)

→ 매수 신호: 분할1 매수
분할1: 67주 @ $29.48 매수
앱 알림: "분할1 매수: 67주 (@$29.48)"

현재 상태:
- 분할1: 보유 67주, 평단가 $29.48, 보유일수 1일
- 분할2~5: 비어있음 (각 $2,000 현금 대기)

// ====================================
// Day 2 (화요일): 1.63% 하락
// ====================================
전일_종가 = $29.48
오늘_종가 = $29.00 (-1.63%)

→ 매수 신호 없음 (하락률 미달)
→ 매도 신호 없음 (분할1 수익률 -1.63%)

앱 알림: "오늘은 매수/매도 없음"

// ====================================
// Day 3 (수요일): 3.45% 하락
// ====================================
전일_종가 = $29.00
오늘_종가 = $28.00 (-3.45%)

→ 매수 신호: 분할2 매수
분할2: 71주 @ $28.00 매수
앱 알림: "분할2 매수: 71주 (@$28.00)"

→ 매도 신호 없음 (분할1, 2 모두 손실 중)

현재 상태:
- 분할1: 보유 67주, 평단가 $29.48, 보유일수 3일, 수익률 -5.0%
- 분할2: 보유 71주, 평단가 $28.00, 보유일수 1일
- 분할3~5: 비어있음

// ====================================
// Day 4 (목요일): 소폭 반등
// ====================================
오늘_종가 = $28.50

→ 매수 신호 없음
→ 매도 신호 없음
  - 분할1: 수익률 -3.32% (미달)
  - 분할2: 수익률 +1.79% (미달)

앱 알림: "오늘은 매수/매도 없음"

// ====================================
// Day 5 (금요일): 추가 반등 + 하락
// ====================================
전일_종가 = $28.50
오늘_종가 = $28.06

→ 매도 신호: 분할2만 매도!
  - 분할2: 수익률 +0.21% → 목표 달성 ✅
  - 분할1: 수익률 -4.82% → 아직 손실

앱 알림: "분할2 매도: 71주 (@$28.06, +0.21%)"

→ 매수 신호: 없음 (하락률 미달)

현재 상태:
- 분할1: 보유 67주, 평단가 $29.48, 보유일수 5일
- 분할2: 비어있음 ($2,014 현금 회수)
- 분할3~5: 비어있음

// ====================================
// Day 6 (월요일): 추가 하락
// ====================================
전일_종가 = $28.06
오늘_종가 = $27.20 (-3.06%)

→ 매수 신호: 분할2 재매수 (비어있었으므로)
분할2: 74주 @ $27.20 매수
앱 알림: "분할2 매수: 74주 (@$27.20)"

→ 매도 신호 없음

현재 상태:
- 분할1: 보유 67주, 평단가 $29.48, 보유일수 6일, 수익률 -7.7%
- 분할2: 보유 74주, 평단가 $27.20, 보유일수 1일
- 분할3~5: 비어있음

// ====================================
// Day 10 (금요일): 큰 반등
// ====================================
오늘_종가 = $29.54

→ 매도 신호: 분할1 매도!
  - 분할1: 수익률 +0.20% → 목표 달성 ✅
  - 분할2: 수익률 +8.60% → 목표 달성 ✅

앱 알림:
  "분할1 매도: 67주 (@$29.54, +0.20%)"
  "분할2 매도: 74주 (@$29.54, +8.60%)"

현재 상태:
- 분할1~5: 모두 비어있음
- 총 현금: $10,180 (약 +1.8% 수익)

// 새로운 사이클 시작 준비 완료 ✅
```

---

## 📱 앱이 제공하는 정보

### **일일 신호 요약**

```javascript
// 장 마감 후 (16:00) 종합 신호
{
  날짜: '2025-01-11',
  종가: $28.50,
  전일_종가: $29.50,
  변동률: -3.39%,

  // 매수 신호 (비어있는 분할 중)
  매수_신호: [
    {
      분할: 3,
      매수량: 70주,
      예상_금액: $1,995,
      수수료: $0.94,
      다음날_실행: '시장가 매수'
    }
  ],

  // 매도 신호 (보유 중인 분할 중)
  매도_신호: [
    {
      분할: 1,
      매도량: 68주,
      예상_금액: $1,938,
      수익률: +0.21%,
      순수익: +$4.12,
      사유: '목표 수익률 달성'
    },
    {
      분할: 2,
      매도량: 71주,
      예상_금액: $2,023.50,
      수익률: +0.31%,
      순수익: +$6.25,
      사유: '목표 수익률 달성'
    }
  ],

  // 순매매량 계산
  순매매: {
    총_매수: 70주,
    총_매도: 139주,
    순매도: 69주,
    실행: '69주 순매도'
  },

  // 보유 현황
  보유_현황: {
    분할1: 'EMPTY',
    분할2: 'EMPTY',
    분할3: 'HOLDING (보유일수 5일)',
    분할4: 'EMPTY',
    분할5: 'EMPTY'
  }
}
```

### **알림 메시지 예시**

```
🔔 2025-01-11 장 마감 신호

📊 종가: $28.50 (-3.39%)

✅ 매도 신호
- 분할1: 68주 매도 (+0.21%, +$4.12)
- 분할2: 71주 매도 (+0.31%, +$6.25)

🚀 매수 신호
- 분할3: 70주 매수 ($1,995)

💡 실행 안내
내일 시장 개장 시:
1. 분할1,2 총 139주 시장가 매도
2. 분할3 70주 시장가 매수
→ 순매도 69주 실행

현재 총 수익: +$142.50 (+1.42%)
```

---

## 🎮 모드별 전략 비교

| 항목 | 안전모드 (Safe) | 공세모드 (Aggressive) |
|------|----------------|----------------------|
| **분할 개수** | 5분할 (독립) | 5분할 (독립) |
| **매수 하락률** | -3.0% | -5.0% |
| **매도 수익률** | +0.2% | +2.5% |
| **최대 보유기간** | 30일 | 7일 |
| **분할별 독립** | ✅ 각각 관리 | ✅ 각각 관리 |
| **동시 매매** | 가능 | 가능 |

### **분할별 독립 운영의 장점**

```
✅ 리스크 분산
- 한 분할 손실해도 다른 분할은 수익 가능
- 시간차 분산 효과

✅ 유연한 매매
- 조건 충족한 분할만 즉시 매도
- 기회 포착 극대화

✅ 복리 효과
- 매도한 분할 즉시 재투자 가능
- 자금 회전율 극대화

✅ 심리적 안정
- 부분 수익 실현으로 심리 안정
- 전량 손실 방지
```

---

## ⚠️ 위험 관리

### **1. 분할별 MDD 추적**

```javascript
// 각 분할별로 독립적으로 MDD 계산
for (let i = 1; i <= 5; i++) {
  const division = portfolio[`division${i}`];

  if (division.status === 'HOLDING') {
    const 현재가치 = division.holdings × 오늘종가;
    const 투자금 = division.holdings × division.avgPrice;
    const 손익률 = (현재가치 - 투자금) / 투자금;

    if (손익률 < division.maxDrawdown) {
      division.maxDrawdown = 손익률;
    }

    console.log(`분할${i} MDD: ${(division.maxDrawdown × 100).toFixed(2)}%`);
  }
}
```

### **2. 최악의 시나리오 대응**

```javascript
// 시나리오: 5분할 모두 손절
분할1: -8.5% 손절 (30일 경과)
분할2: -12.3% 손절 (30일 경과)
분할3: -15.7% 손절 (30일 경과)
분할4: -18.2% 손절 (30일 경과)
분할5: -20.1% 손절 (30일 경과)

평균_손실: -14.96%
전체_손실: 약 -$1,496

→ 하지만 시차로 인해 일부 분할은 수익 실현 가능
→ 실제 손실은 평균보다 낮을 가능성 높음
```

### **3. 분할 상태 모니터링**

```javascript
// 일일 체크리스트
□ 각 분할별 보유일수 확인
□ 각 분할별 수익률 확인
□ 손절 임박 분할 체크 (보유 25일 이상)
□ 비어있는 분할 개수 확인
□ 전체 포트폴리오 수익률 계산
```

---

## 📊 백테스팅 결과 (분할별 독립 운영)

### **안전모드 3개월**
```
기간: 2024-10-01 ~ 2025-01-01
초기 자본: $10,000 (분할당 $2,000)
분할 방식: 5분할 독립 운영

결과:
────────────────
최종 자산: $10,580
총 수익: $580
수익률: +5.80%
총 거래: 42회
├─ 매수: 21회
└─ 매도: 21회

분할별 성과:
├─ 분할1: 5사이클, 승률 80%, +$145
├─ 분할2: 4사이클, 승률 75%, +$128
├─ 분할3: 4사이클, 승률 100%, +$156
├─ 분할4: 4사이클, 승률 75%, +$102
└─ 분할5: 4사이클, 승률 50%, +$49

평균 보유 기간: 6.8일
최대 동시 보유: 4분할
최대 MDD: -9.2%
총 수수료: $37.82
```

### **공세모드 3개월**
```
기간: 2024-10-01 ~ 2025-01-01
초기 자본: $10,000
분할 방식: 5분할 독립 운영

결과:
────────────────
최종 자산: $10,890
총 수익: $890
수익률: +8.90%
총 거래: 24회
├─ 매수: 12회
└─ 매도: 12회

분할별 성과:
├─ 분할1: 3사이클, 승률 100%, +$245
├─ 분할2: 2사이클, 승률 100%, +$198
├─ 분할3: 3사이클, 승률 67%, +$187
├─ 분할4: 2사이클, 승률 100%, +$152
└─ 분할5: 2사이클, 승률 50%, +$108

평균 보유 기간: 5.2일
최대 동시 보유: 3분할
최대 MDD: -14.5%
총 수수료: $21.45
```

---

## ✅ 핵심 요약

### **분할별 독립 운영 5원칙**

```
1. 각 분할은 독립된 포트폴리오 (개별 관리)
2. 매일 모든 분할 조건 체크 (매수/매도)
3. 조건 충족한 분할만 즉시 실행
4. 순매매량 계산하여 실제 주문 최소화
5. 분할별 수익률 및 보유기간 추적
```

### **투자금 설정 가이드**

```javascript
최소_권장 = $5,000
이유: 5분할 시 분할당 $1,000

권장_투자금:
- 초보자: $5,000 ~ $10,000
- 중급자: $10,000 ~ $20,000
- 숙련자: $20,000 ~ $50,000

계산:
분할당_금액 = 투자금 / 5
SOXL_가격 = 약 $25~35
분할당_주수 = 약 30~80주
```

### **성공의 핵심**

```
✅ 분할별 독립 추적 (혼동 방지)
✅ 조건 충족 시 즉시 실행 (기회 포착)
✅ 순매매 계산 (효율적 거래)
✅ 기록 관리 (분할별 성과 분석)
✅ 감정 통제 (기계적 실행)
```

---

**⚠️ 투자 유의사항**

```
본 문서는 교육 목적의 전략 설명입니다.
투자 권유가 아니며, 모든 투자 결정은 본인 책임입니다.
원금 손실 가능성을 항상 인지하고 투자하시기 바랍니다.
```

---

**문서 버전**: v3.0 (5분할 독립 운영)
**최종 수정일**: 2025-01-11
**출처**: 구글 시트 동파법 전략 분석
**작성자**: 동파법 SOXL 프로젝트팀
